# 游戏任务系统详细文档

本文档详细介绍游戏中所有任务的触发条件、完成方法、属性和奖励信息。

## 任务分类

游戏任务分为两大类：
- **主线任务**：推动游戏剧情发展的核心任务
- **支线任务**：丰富游戏内容的可选任务

## 主线任务

### 1. 初来乍到

**任务属性：**
- 类型：主线任务
- 描述：作为新来的冒险者，你需要先了解这个村庄的情况

**触发条件：**
- 玩家进入"村中心"房间

**完成方法：**
- 任务目标：探索村庄，了解基本情况
- 目标类型：explore (探索)
- 目标对象：村中心
- 目标数量：1

**奖励：**
- 经验值：50
- 侠义值：5
- 物品：无
- 奖励描述：完成村庄探索

**后续任务：**
- 完成后触发"森林的威胁"任务

### 2. 森林的威胁

**任务属性：**
- 类型：主线任务
- 描述：村庄附近的森林里有野狼出没，威胁着村民的安全

**触发条件：**
- 玩家位于"森林"房间
- 或完成"初来乍到"任务后自动触发

**完成方法：**
- 任务目标：击败森林中的野狼
- 目标类型：kill (击杀)
- 目标对象：野狼
- 目标数量：1

**奖励：**
- 经验值：100
- 侠义值：10
- 物品：狼牙项链（武器，攻击力+3）
- 奖励描述：击败野狼的奖励

**后续任务：**
- 完成后触发"山洞的邪恶"任务

### 3. 山洞的邪恶

**任务属性：**
- 类型：主线任务
- 描述：山洞中的哥布林是更大的威胁，必须清除

**触发条件：**
- 玩家位于"山洞"房间
- 或完成"森林的威胁"任务后自动触发

**完成方法：**
- 任务目标：击败山洞中的哥布林
- 目标类型：kill (击杀)
- 目标对象：哥布林
- 目标数量：1

**奖励：**
- 经验值：200
- 侠义值：20
- 物品：精铁剑（武器，攻击力+8）
- 奖励描述：击败哥布林的奖励

## 支线任务

### 1. 村民的忧虑

**任务属性：**
- 类型：支线任务
- 描述：村民似乎有什么烦恼，去和他聊聊

**触发条件：**
- 与"村民"NPC对话

**完成方法：**
- 任务目标：与村民对话
- 目标类型：talk (对话)
- 目标对象：村民
- 目标数量：1

**奖励：**
- 经验值：25
- 侠义值：2
- 物品：草药（药品，回复15点生命值）
- 奖励描述：村民的好感

### 2. 收集木材

**任务属性：**
- 类型：支线任务
- 描述：铁匠需要一些木材来修理工具

**触发条件：**
- 与"铁匠"NPC对话

**完成方法：**
- 任务目标：收集5个木材
- 目标类型：collect (收集)
- 目标对象：木材
- 目标数量：5

**奖励：**
- 经验值：75
- 侠义值：3
- 物品：金币（其他类型）
- 奖励描述：收集木材的报酬

### 3. 采集草药

**任务属性：**
- 类型：支线任务
- 描述：客栈老板需要一些草药来制作药剂

**触发条件：**
- 与"客栈老板"NPC对话

**完成方法：**
- 任务目标：收集3个草药
- 目标类型：collect (收集)
- 目标对象：草药
- 目标数量：3

**奖励：**
- 经验值：60
- 侠义值：5
- 物品：治疗药水（药品，回复30点生命值）
- 奖励描述：收集草药的奖励

### 4. 森林异变

**任务属性：**
- 类型：支线任务
- 描述：森林中的动物行为异常，需要调查原因

**触发条件：**
- 与"老猎人"NPC对话

**完成方法：**
- 任务目标：调查森林异常
- 目标类型：explore (探索)
- 目标对象：森林
- 目标数量：1

**奖励：**
- 经验值：120
- 侠义值：8
- 物品：猎人徽章（防具，防御力+5）
- 奖励描述：调查森林的奖励

**后续任务：**
- 完成后与"隐士"对话可能触发新的对话内容

### 5. 山顶净化

**任务属性：**
- 类型：支线任务
- 描述：山顶被邪恶力量污染，需要帮助隐士进行净化仪式

**触发条件：**
- 与"隐士"NPC对话

**完成方法：**
- 任务目标：净化山顶
- 目标类型：explore (探索)
- 目标对象：山顶
- 目标数量：1

**奖励：**
- 经验值：150
- 侠义值：15
- 物品：净化法杖（武器，攻击力+12）
- 奖励描述：净化山顶的奖励

### 6. 客栈护卫

**任务属性：**
- 类型：支线任务
- 描述：客栈老板担心野狼威胁客栈安全，需要你清理森林中的野狼

**触发条件：**
- 与"客栈老板"NPC对话

**完成方法：**
- 任务目标：保护客栈（击败2只野狼）
- 目标类型：kill (击杀)
- 目标对象：野狼
- 目标数量：2

**奖励：**
- 经验值：100
- 侠义值：12
- 物品：特制美酒（药品，回复25点生命值）
- 奖励描述：保护客栈的奖励

**后续效果：**
- 完成后与客栈老板的关系改善（关系值+20）

### 7. 珍贵矿石

**任务属性：**
- 类型：支线任务
- 描述：铁匠需要山洞中的珍贵矿石来打造高级装备

**触发条件：**
- 与"铁匠"NPC对话

**完成方法：**
- 任务目标：寻找矿石
- 目标类型：collect (收集)
- 目标对象：矿石
- 目标数量：1

**奖励：**
- 经验值：80
- 侠义值：10
- 物品：精钢护甲（防具，防御力+10）
- 奖励描述：寻找矿石的奖励

## 连锁任务

### 1. 隐士的指引（连锁任务第一环）

**任务属性：**
- 类型：支线任务（连锁任务）
- 描述：山顶的隐士似乎知道一些秘密，去和他谈谈

**触发条件：**
- 与"隐士"NPC对话

**完成方法：**
- 任务目标：与隐士对话
- 目标类型：talk (对话)
- 目标对象：隐士
- 目标数量：1

**奖励：**
- 经验值：50
- 侠义值：5
- 物品：无
- 奖励描述：隐士的智慧

**后续任务：**
- 完成后再次与"隐士"对话触发"净化材料"任务

### 2. 净化材料（连锁任务第二环）

**任务属性：**
- 类型：支线任务（连锁任务）
- 描述：隐士需要一些特殊的草药来制作净化药剂

**触发条件：**
- 完成"隐士的指引"任务后与"隐士"对话

**完成方法：**
- 任务目标：收集净化材料
- 目标类型：collect (收集)
- 目标对象：草药
- 目标数量：5

**奖励：**
- 经验值：100
- 侠义值：8
- 物品：净化粉末（其他类型）
- 奖励描述：收集净化材料

**后续任务：**
- 完成后再次与"隐士"对话可能触发"山顶净化"任务

## 扩展地图任务

### 1. 古庙祈福

**任务属性：**
- 类型：支线任务
- 描述：古庙的老和尚邀请你参拜，据说能获得佛祖庇佑

**触发条件：**
- 与"老和尚"NPC对话

**完成方法：**
- 任务目标：参拜古庙
- 目标类型：explore (探索)
- 目标对象：古庙
- 目标数量：1

**奖励：**
- 经验值：90
- 侠义值：7
- 物品：祈福符（其他类型，增加幸运值）
- 奖励描述：参拜古庙的奖励

### 2. 商人的请求

**任务属性：**
- 类型：支线任务
- 描述：旅行商人需要一些稀有物品，愿意用珍贵商品交换

**触发条件：**
- 与"旅行商人"NPC对话

**完成方法：**
- 任务目标：与商人交易
- 目标类型：talk (对话)
- 目标对象：旅行商人
- 目标数量：1

**奖励：**
- 经验值：110
- 侠义值：9
- 物品：商人的货物（其他类型）
- 奖励描述：与商人交易的奖励

### 3. 稀有草药

**任务属性：**
- 类型：支线任务
- 描述：药师需要一些稀有草药来配制特殊药剂

**触发条件：**
- 与"药师"NPC对话

**完成方法：**
- 任务目标：采集稀有草药
- 目标类型：collect (收集)
- 目标对象：草药
- 目标数量：5

**奖励：**
- 经验值：130
- 侠义值：11
- 物品：药师的药剂（药品，回复40点生命值）
- 奖励描述：采集草药的奖励

### 4. 武师考验

**任务属性：**
- 类型：支线任务
- 描述：武师要求你先证明自己的实力，击败竹林中的盗贼

**触发条件：**
- 与"武师"NPC对话

**完成方法：**
- 任务目标：通过武师考验
- 目标类型：kill (击杀)
- 目标对象：竹林盗贼
- 目标数量：1

**奖励：**
- 经验值：160
- 侠义值：14
- 物品：武师秘籍（其他类型，学会新技能）
- 奖励描述：通过考验的奖励

### 5. 湖心亭之谜

**任务属性：**
- 类型：支线任务
- 描述：湖心亭最近出现奇怪的光芒，书生希望你能调查

**触发条件：**
- 与"书生"NPC对话

**完成方法：**
- 任务目标：调查湖心亭
- 目标类型：explore (探索)
- 目标对象：湖心亭
- 目标数量：1

**奖励：**
- 经验值：95
- 侠义值：6
- 物品：书生的诗集（其他类型，增加文化修养）
- 奖励描述：调查湖心亭的奖励

### 6. 竹林清修

**任务属性：**
- 类型：支线任务
- 描述：竹林中的盗贼扰乱了隐士的清修，需要你帮忙驱赶

**触发条件：**
- 与"女隐士"NPC对话

**完成方法：**
- 任务目标：驱赶竹林盗贼
- 目标类型：kill (击杀)
- 目标对象：竹林盗贼
- 目标数量：1

**奖励：**
- 经验值：140
- 侠义值：12
- 物品：隐士的信物（其他类型，可以进入神秘地点）
- 奖励描述：驱赶盗贼的奖励

### 7. 怨灵净化

**任务属性：**
- 类型：支线任务
- 描述：废弃小屋中的怨灵需要被净化，才能获得安宁

**触发条件：**
- 与"女隐士"NPC对话

**完成方法：**
- 任务目标：净化废弃小屋
- 目标类型：kill (击杀)
- 目标对象：怨灵
- 目标数量：1

**奖励：**
- 经验值：170
- 侠义值：16
- 物品：净化宝珠（其他类型，攻击力+15）
- 奖励描述：净化废弃小屋的奖励

### 8. 宝藏守护者

**任务属性：**
- 类型：支线任务
- 描述：地下大厅的守护灵守护着珍贵的宝藏，只有击败它才能获得

**触发条件：**
- 与"守护灵"NPC对话

**完成方法：**
- 任务目标：击败守护灵
- 目标类型：kill (击杀)
- 目标对象：守护灵
- 目标数量：1

**奖励：**
- 经验值：200
- 侠义值：20
- 物品：宝藏钥匙（其他类型）
- 奖励描述：击败守护灵的奖励

## 任务系统机制详解

### 任务状态

任务有三种状态：
- **NOT_ACCEPTED**：任务尚未接受
- **IN_PROGRESS**：任务进行中
- **COMPLETED**：任务已完成

### 任务目标类型

任务目标分为四种类型：
1. **explore**：探索特定地点
2. **kill**：击杀特定生物
3. **collect**：收集特定物品
4. **talk**：与特定NPC对话

### 任务触发机制

任务触发主要有以下几种方式：
1. **位置触发**：玩家进入特定房间时触发
2. **对话触发**：与特定NPC对话时触发
3. **连锁触发**：完成前置任务后触发

### 任务进度更新

当玩家执行与任务目标相关的操作时，任务进度会自动更新：
- 探索新区域时更新探索类任务
- 击杀生物时更新击杀类任务
- 收集物品时更新收集类任务
- 与NPC对话时更新对话类任务

### 任务奖励发放

当任务完成时，系统会自动发放以下奖励：
- 经验值：提升玩家等级
- 侠义值：影响NPC对玩家的态度
- 物品：各种装备、药品或特殊物品

## 任务系统代码结构

### 核心类

1. **Task**：任务类，包含任务名称、描述、状态、目标、奖励等属性
2. **TaskObjective**：任务目标类，定义任务需要完成的具体内容
3. **Reward**：奖励类，定义任务完成后获得的奖励
4. **TaskManager**：任务管理器，负责任务的初始化、触发、进度更新等

### 关键方法

- **Task.acceptTask()**：接受任务
- **Task.updateProgress()**：更新任务进度
- **Task.checkComplete()**：检查任务是否完成
- **TaskManager.checkTaskTriggers()**：检查任务触发条件
- **TaskManager.updateTaskProgress()**：更新任务进度
- **TaskManager.checkFollowUpTasks()**：检查并触发后续任务

## 任务流程示例

1. 玩家进入村中心，触发"初来乍到"任务
2. 玩家接受任务，任务状态变为进行中
3. 玩家探索村中心，完成任务目标
4. 任务自动完成，玩家获得奖励
5. 系统自动触发后续任务"森林的威胁"

---

本文档基于游戏源代码自动生成，包含了游戏中所有21个任务的详细信息。